
> mina-zkapp-e2e-testing@0.1.0 test
> cross-env TEST_ON_BERKELEY=true node --max-old-space-size=8000 --experimental-vm-modules --experimental-wasm-threads node_modules/jest/bin/jest.js

  console.log
    sync Berkeley Network status: done!

      at syncNetworkStatus (src/Membership.test.ts:22:21)

  console.log
    current network state:  {"snarkedLedgerHash":"21770522398937999778825571685444670265630054578135253647542676552896725309670","blockchainLength":"2398","minWindowDensity":"33","totalCurrency":"1015044564000001000","globalSlotSinceGenesis":"4137","nextEpochData":{"ledger":{"hash":"10441704273186663328169056579523148910706520223510775933549410806300798803187","totalCurrency":"1013459001000001000"},"seed":"14191682850256009689863066075576147807943870030536893757628031642948839038758","startCheckpoint":"0","lockCheckpoint":"3791347084243354584908336668289964638202138185091846615416981011146256266237","epochLength":"2399"},"stakingEpochData":{"ledger":{"hash":"10441704273186663328169056579523148910706520223510775933549410806300798803187","totalCurrency":"1013459001000001000"},"seed":"0","startCheckpoint":"0","lockCheckpoint":"0","epochLength":"1"}}

      at syncNetworkStatus (src/Membership.test.ts:24:17)

  console.log
    Funding fee payer B62qnBQr8uuaa8QZdDgTGW5aSyKhi637v1sPzjxxtwrGxxV7TXx69LS and waiting for inclusion in a block..

      at Object.<anonymous> (src/Membership.test.ts:62:21)

  console.log
    [checkAccountExists]: true, account: {"publicKey":"B62qnBQr8uuaa8QZdDgTGW5aSyKhi637v1sPzjxxtwrGxxV7TXx69LS","tokenId":"1","tokenSymbol":"","balance":"49000000000","nonce":"0","receiptChainHash":"14564582992068613478915821183083107733064540968050799295374021047658500056219","delegate":"B62qnBQr8uuaa8QZdDgTGW5aSyKhi637v1sPzjxxtwrGxxV7TXx69LS","votingFor":"0","timing":{"isTimed":false,"initialMinimumBalance":"0","cliffTime":"0","cliffAmount":"0","vestingPeriod":"0","vestingIncrement":"0"},"permissions":{"editState":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"access":{"constant":true,"signatureNecessary":false,"signatureSufficient":true},"send":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"receive":{"constant":true,"signatureNecessary":false,"signatureSufficient":true},"setDelegate":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setPermissions":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setVerificationKey":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setZkappUri":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"editActionState":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setTokenSymbol":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"incrementNonce":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setVotingFor":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setTiming":{"constant":false,"signatureNecessary":true,"signatureSufficient":true}}}

      at loopUntilAccountExists (src/utils.ts:111:13)

  console.log
    senderAccount is funded!

      at Object.<anonymous> (src/Membership.test.ts:70:21)

  console.log
    senderKey: EKFFgxjZUf5soC93cZf4ycPeifG1xv25zSNzAtQV6SWHzqxckyqH, senderAccount: B62qnBQr8uuaa8QZdDgTGW5aSyKhi637v1sPzjxxtwrGxxV7TXx69LS

      at Object.<anonymous> (src/Membership.test.ts:76:17)

  console.log
    initially, senderAccount.nonce: 0, senderAccount.balance: 49000000000

      at Object.<anonymous> (src/Membership.test.ts:79:17)

  console.log
    zkAppAddress:  B62qjjgqrq1bmUutctKJVLmvUJc8PSVGQnqYcP21kPzpJwDmpWqNCHi

      at Object.<anonymous> (src/Membership.test.ts:84:17)

  console.log
    Membership Contract: deploying...

      at Object.<anonymous> (src/Membership.test.ts:87:17)

  console.log
    Membership Contract: deployment tx[5JvJVPvUapKfMCsBBQKTJHy7jsKkxUzZCwNsdRQbR7kaJX6WomKy] sent...

      at Object.<anonymous> (src/Membership.test.ts:93:17)

  console.log
    Membership Contract: txId.isSuccess: true

      at Object.<anonymous> (src/Membership.test.ts:95:17)

  console.log
    [checkAccountExists]: true, account: {"publicKey":"B62qjjgqrq1bmUutctKJVLmvUJc8PSVGQnqYcP21kPzpJwDmpWqNCHi","tokenId":"1","tokenSymbol":"","balance":"0","nonce":"1","receiptChainHash":"26929451230198866698764489740646554722022077380843922791448965064057180620057","delegate":"B62qjjgqrq1bmUutctKJVLmvUJc8PSVGQnqYcP21kPzpJwDmpWqNCHi","votingFor":"0","timing":{"isTimed":false,"initialMinimumBalance":"0","cliffTime":"0","cliffAmount":"0","vestingPeriod":"0","vestingIncrement":"0"},"permissions":{"editState":{"constant":false,"signatureNecessary":false,"signatureSufficient":false},"access":{"constant":true,"signatureNecessary":false,"signatureSufficient":true},"send":{"constant":false,"signatureNecessary":false,"signatureSufficient":true},"receive":{"constant":true,"signatureNecessary":false,"signatureSufficient":true},"setDelegate":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setPermissions":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setVerificationKey":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setZkappUri":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"editActionState":{"constant":false,"signatureNecessary":false,"signatureSufficient":false},"setTokenSymbol":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"incrementNonce":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setVotingFor":{"constant":false,"signatureNecessary":true,"signatureSufficient":true},"setTiming":{"constant":false,"signatureNecessary":true,"signatureSufficient":true}},"zkapp":{"appState":["22731122946631793544306773678309960639073656601863129978322145324846701682624","0","0","0","0","0","0","0"],"verificationKey":{"data":"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","hash":"26812838495925411362495612980875310724336592740400539280496255089478447810059"},"zkappVersion":"0","actionState":["25079927036070901246064867767436987657692091363973573142121686150614948079097","25079927036070901246064867767436987657692091363973573142121686150614948079097","25079927036070901246064867767436987657692091363973573142121686150614948079097","25079927036070901246064867767436987657692091363973573142121686150614948079097","25079927036070901246064867767436987657692091363973573142121686150614948079097"],"lastActionSlot":"0","provedState":false,"zkappUri":""}}

      at loopUntilAccountExists (src/utils.ts:111:13)

  console.log
    Membership Contract: deployment done!

      at Object.<anonymous> (src/Membership.test.ts:103:17)

  console.log
    membershipMerkleMap's initial root: 22731122946631793544306773678309960639073656601863129978322145324846701682624

      at Object.<anonymous> (src/Membership.test.ts:107:17)

  console.log
    ===================[CHECK tx should succeed when store an non-existing user]===================

      at Object.<anonymous> (src/Membership.test.ts:111:17)

  console.log
    oneUserPriKey: EKEn1EnccHJi3yVRLXZnbq9TFDZ8PPQaDy4FPemnTwTi3WDQHfDx,  oneUserPubKey: B62qo9xzarWocx3ht4gPo2E8Gnv3HjC7b5Q6ZYkFmddk2to7vtFKSyd

      at Object.<anonymous> (src/Membership.test.ts:115:17)

  console.log
    oneUserValue: 0

      at Object.<anonymous> (src/Membership.test.ts:120:17)

  console.log
    check non-existence false

      at node_modules/snarkyjs/src/lib/circuit_value.ts:1082:13

  console.log
    check non-existence false

      at node_modules/snarkyjs/src/lib/circuit_value.ts:1082:13

  console.log
    check non-existence false

      at node_modules/snarkyjs/src/lib/circuit_value.ts:1082:13

  console.log
    Sending the transaction...

      at makeAndSendTransaction (src/utils.ts:168:11)

  console.log
    See transaction at https://berkeley.minaexplorer.com/transaction/5JuT1TeSs6sekMWAMXLFmSPp86ib3abXN5fTMnZmBJHawGJYxCAE

      at makeAndSendTransaction (src/utils.ts:175:13)

  console.log
    waiting for zkApp state to change... (current state:  0)

      at makeAndSendTransaction (src/utils.ts:185:13)

  console.log
    ==== stateChanged:  false

      at makeAndSendTransaction (src/utils.ts:195:13)

  console.log
    waiting for zkApp state to change... (current state:  0)

      at makeAndSendTransaction (src/utils.ts:185:13)

  console.log
    ==== stateChanged:  false

      at makeAndSendTransaction (src/utils.ts:195:13)

  console.log
    waiting for zkApp state to change... (current state:  0)

      at makeAndSendTransaction (src/utils.ts:185:13)

  console.log
    ==== stateChanged:  true

      at makeAndSendTransaction (src/utils.ts:195:13)

  console.log
    ===================As Expected, tx succeed when store an non-existing user===================

      at Object.<anonymous> (src/Membership.test.ts:146:17)

  console.log
    ===================[CHECK tx should fail when store an existing user]===================

      at Object.<anonymous> (src/Membership.test.ts:149:17)

  console.log
    check non-existence true

      at node_modules/snarkyjs/src/lib/circuit_value.ts:1082:13

  console.log
    ===================As Expected, tx fails when store an existing user===================

      at Object.<anonymous> (src/Membership.test.ts:175:21)

  console.error
    Error: assert_equal: 0x0000000000000000000000000000000000000000000000000000000000000001 != 0x0000000000000000000000000000000000000000000000000000000000000000
        at failwith (/home/gregor/.opam/4.14.0/lib/ocaml/stdlib.ml:29:34)
        at /home/gregor/.opam/4.14.0/lib/base/printf.ml:6:43
        at caml_call_gen (/builtin/+stdlib.js:32:12)
        at /builtin/+stdlib.js:42:14
        at caml_call_gen (/builtin/+stdlib.js:28:22)
        at caml_call_gen (/builtin/+stdlib.js:34:12)
        at caml_call_gen (/builtin/+stdlib.js:34:12)
        at caml_call3 (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/dist/node/_node_bindings/snarky_js_node.bc.cjs:7616:40)
        at assert_equal (/workspace_root/src/lib/snarky/src/base/checked.ml:84:11)
        at caml_call3 (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/dist/node/_node_bindings/snarky_js_node.bc.cjs:7616:28)
        at symbol$2 (/workspace_root/src/lib/snarky/src/base/utils.ml:388:39)
        at caml_call2 (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/dist/node/_node_bindings/snarky_js_node.bc.cjs:7614:28)
        at symbol$6 (/workspace_root/src/lib/snarky/src/base/snark0.ml:873:29)
        at caml_call2 (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/dist/node/_node_bindings/snarky_js_node.bc.cjs:7614:28)
        at /root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/dist/node/_node_bindings/snarky_js_node.bc.cjs:427925:31
        at caml_call_gen (/builtin/+stdlib.js:32:12)
        at /builtin/+jslib.js:252:14
        at Object.eval [as assertFalse] (eval at caml_js_eval_string (/builtin/+jslib.js:328:42), <anonymous>:4:20)
        at Membership.addNewMember (/root/mina_workspace/mina-zkapp-e2e-testing-condition/src/Membership.ts:51:17)
        at /root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/zkapp.ts:324:24
        at runWith (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/global-context.ts:89:14)
        at Function.runWith (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/global-context.ts:43:9)
        at /root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/zkapp.ts:317:61
        at runWith (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/global-context.ts:89:14)
        at Function.runWith (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/global-context.ts:43:9)
        at Membership.wrappedMethod (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/zkapp.ts:175:35)
        at mutateZkApp (/root/mina_workspace/mina-zkapp-e2e-testing-condition/src/Membership.test.ts:159:27)
        at /root/mina_workspace/mina-zkapp-e2e-testing-condition/src/utils.ts:163:7
        at createTransaction (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/mina.ts:229:11)
        at Object.transaction (/root/mina_workspace/mina-zkapp-e2e-testing-condition/node_modules/snarkyjs/src/lib/mina.ts:848:14)
        at processTicksAndRejections (node:internal/process/task_queues:96:5)
        at makeAndSendTransaction (/root/mina_workspace/mina-zkapp-e2e-testing-condition/src/utils.ts:160:21)
        at Object.<anonymous> (/root/mina_workspace/mina-zkapp-e2e-testing-condition/src/Membership.test.ts:155:13)

      174 |         } catch (error) {
      175 |             console.log('===================As Expected, tx fails when store an existing user===================');
    > 176 |             console.error(error);
          |                     ^
      177 |         }
      178 |         // store the user
      179 |         expect(zkApp.memberTreeRoot.get()).toEqual(merkleRoot0);

      at Object.<anonymous> (src/Membership.test.ts:176:21)

